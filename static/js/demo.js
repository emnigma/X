
goog.require('X.renderer3D')
goog.require('X.renderer2D')
goog.require('X.mesh')

async function readTextFile(file, _callback) {
  var rawFile = new XMLHttpRequest();
  rawFile.open("GET", file, false);
  rawFile.onreadystatechange = function () {
    if (rawFile.readyState === 4) {
      if (rawFile.status === 200 || rawFile.status == 0) {
        var allText = rawFile.responseText;
        let strings = allText.split("\n")

        // strings -  массив строк-координат вида "003 -13.56107 -100.80030 -4.76664 2.75910"
        _callback(strings)
      }
    }
  }
  rawFile.send(null);
}

window.onload = function () {
  //
  // try to create the 3D renderer
  //
  _webGLFriendly = true;
  try {
    // try to create and initialize a 3D renderer
    threeD = new X.renderer3D();
    threeD.container = '3d';
    threeD.init()

  } catch (Exception) {

    // no webgl on this machine
    _webGLFriendly = false;

  }

  sliceX = new X.renderer2D();
  
  sliceX.container = 'sliceX';
  sliceX.orientation = 'X';
  sliceX.init();
  var slicex_interactor = sliceX.interactor
  // sliceX.interactor.onMouseDown = function ($LEFT, $MIDDLE, $RIGHT) {
  //   console.log(slicex_interactor.mousePosition)
  // }

  // .. for Y
  var sliceY = new X.renderer2D();
  sliceY.container = 'sliceY';
  sliceY.orientation = 'Y';
  sliceY.init();
  // .. and for Z
  var sliceZ = new X.renderer2D();
  sliceZ.container = 'sliceZ';
  sliceZ.orientation = 'Z';
  sliceZ.init();
  sliceZ.canvasTransformer = function(data) {
    let mockData = {
      "vertexes": [
        {
          "x": 101.10997751953124,
          "y": 62.3829342993005,
          "z": 164.98936043910368,
          "thickness": 2.47953
        },
        {
          "x": 110.32492751953126,
          "y": 63.29145435366489,
          "z": 164.9626704375066,
          "thickness": 2.69795
        },
        {
          "x": 102.11031751953125,
          "y": 65.68883449712025,
          "z": 165.04225044226857,
          "thickness": 1.21645
        },
        {
          "x": 98.58764751953125,
          "y": 66.37317453807005,
          "z": 164.9738604381762,
          "thickness": 1.40918
        },
        {
          "x": 104.27253751953126,
          "y": 68.02294463678963,
          "z": 165.00617044010954,
          "thickness": 1.4428
        },
        {
          "x": 93.35897751953125,
          "y": 67.10364458178022,
          "z": 165.0007004397823,
          "thickness": 1.62728
        },
        {
          "x": 100.41048751953124,
          "y": 68.03074463725638,
          "z": 164.98796043901993,
          "thickness": 1.26886
        },
        {
          "x": 103.88109751953125,
          "y": 68.68484467639666,
          "z": 164.9681504378345,
          "thickness": 1.50182
        },
        {
          "x": 95.09492751953125,
          "y": 68.82665468488234,
          "z": 165.01579044068524,
          "thickness": 1.85812
        },
        {
          "x": 89.06860751953124,
          "y": 69.8058547434761,
          "z": 164.97950043851367,
          "thickness": 1.83802
        },
        {
          "x": 91.91480751953125,
          "y": 73.4962549643037,
          "z": 164.9595304373187,
          "thickness": 1.43107
        },
        {
          "x": 109.23316751953125,
          "y": 75.27138507052463,
          "z": 165.01083044038842,
          "thickness": 1.89339
        },
        {
          "x": 88.21624751953125,
          "y": 77.16357518375024,
          "z": 164.95798043722598,
          "thickness": 2.3549
        },
        {
          "x": 70.90392751953125,
          "y": 77.64479521254566,
          "z": 164.96365043756524,
          "thickness": 2.96943
        },
        {
          "x": 114.01554751953125,
          "y": 77.8804652266478,
          "z": 165.02754044138834,
          "thickness": 1.78076
        },
        {
          "x": 88.99171751953125,
          "y": 78.46284526149647,
          "z": 164.9688704378776,
          "thickness": 2.56803
        },
        {
          "x": 95.27415751953126,
          "y": 83.46725556095231,
          "z": 165.00446044000728,
          "thickness": 1.25815
        },
        {
          "x": 69.78434751953125,
          "y": 84.3621056144987,
          "z": 164.97539043826774,
          "thickness": 1.99299
        },
        {
          "x": 72.19645751953125,
          "y": 84.85405564393619,
          "z": 165.03477044182097,
          "thickness": 2.23649
        },
        {
          "x": 96.43872751953126,
          "y": 86.20214572460374,
          "z": 164.96853043785725,
          "thickness": 1.87959
        },
        {
          "x": 75.93507751953125,
          "y": 86.09947571846013,
          "z": 165.03110044160135,
          "thickness": 2.04089
        },
        {
          "x": 111.98067751953126,
          "y": 87.0284057740458,
          "z": 164.96415043759518,
          "thickness": 3.12772
        },
        {
          "x": 84.88766751953125,
          "y": 86.97375577077564,
          "z": 165.04610044249893,
          "thickness": 2.15592
        },
        {
          "x": 77.10181751953125,
          "y": 87.06005577593967,
          "z": 165.00075043978526,
          "thickness": 2.02497
        },
        {
          "x": 109.30685751953125,
          "y": 86.81116576104651,
          "z": 165.01125044041356,
          "thickness": 2.92848
        },
        {
          "x": 108.03733751953125,
          "y": 88.0976858380298,
          "z": 165.02497044123456,
          "thickness": 2.87967
        },
        {
          "x": 113.49702751953124,
          "y": 88.36816585421488,
          "z": 165.03534044185508,
          "thickness": 3.29552
        },
        {
          "x": 107.74052751953126,
          "y": 88.90609588640376,
          "z": 164.9782404384383,
          "thickness": 2.85849
        },
        {
          "x": 107.17360751953125,
          "y": 89.5369459241528,
          "z": 164.97426043820016,
          "thickness": 2.67427
        },
        {
          "x": 78.52751751953124,
          "y": 90.0430559544376,
          "z": 164.9844804388117,
          "thickness": 2.29621
        },
        {
          "x": 61.25097751953125,
          "y": 88.89454588571262,
          "z": 164.95759043720264,
          "thickness": 2.42518
        },
        {
          "x": 107.05957751953125,
          "y": 90.40964597637377,
          "z": 164.9948404394316,
          "thickness": 2.72875
        },
        {
          "x": 98.27197751953125,
          "y": 91.48583604077125,
          "z": 164.9520104368687,
          "thickness": 1.84491
        },
        {
          "x": 63.48066751953125,
          "y": 91.42807603731498,
          "z": 164.97905043848675,
          "thickness": 2.60971
        },
        {
          "x": 113.99166751953125,
          "y": 92.41822609656396,
          "z": 165.03528044185148,
          "thickness": 3.2181
        },
        {
          "x": 87.12996751953125,
          "y": 92.0473560743717,
          "z": 165.04882044266168,
          "thickness": 1.89275
        },
        {
          "x": 78.16933751953124,
          "y": 92.41247609621989,
          "z": 164.9696904379267,
          "thickness": 2.8173
        },
        {
          "x": 72.78439751953124,
          "y": 93.76417617710345,
          "z": 164.97782043841315,
          "thickness": 3.12923
        },
        {
          "x": 91.79850751953126,
          "y": 94.23651620536752,
          "z": 165.00334043994025,
          "thickness": 2.39255
        },
        {
          "x": 91.04324751953125,
          "y": 94.83453624115205,
          "z": 165.0034804399486,
          "thickness": 2.56276
        },
        {
          "x": 65.03709751953124,
          "y": 94.73700623531604,
          "z": 164.95925043730193,
          "thickness": 2.71809
        },
        {
          "x": 67.72739751953125,
          "y": 99.25323650555997,
          "z": 164.99869043966197,
          "thickness": 2.30017
        },
        {
          "x": 69.04896751953126,
          "y": 100.7870265973395,
          "z": 165.04224044226797,
          "thickness": 2.27324
        },
        {
          "x": 73.78542751953125,
          "y": 102.89231672331667,
          "z": 165.0096604403184,
          "thickness": 2.44962
        },
        {
          "x": 109.95236751953125,
          "y": 103.81065677826865,
          "z": 165.0432504423284,
          "thickness": 2.25472
        },
        {
          "x": 65.95763751953125,
          "y": 105.52534688087293,
          "z": 165.01080044038665,
          "thickness": 2.66289
        },
        {
          "x": 66.49586751953126,
          "y": 107.72095701225473,
          "z": 164.9899404391384,
          "thickness": 3.03398
        },
        {
          "x": 57.14946751953126,
          "y": 109.75394713390557,
          "z": 164.98981043913062,
          "thickness": 3.59766
        },
        {
          "x": 72.67818751953125,
          "y": 114.26815740402864,
          "z": 164.98934043910248,
          "thickness": 2.2393
        },
        {
          "x": 110.12192751953125,
          "y": 116.62817754524845,
          "z": 164.99457043941547,
          "thickness": 1.30607
        },
        {
          "x": 111.47247751953125,
          "y": 118.42391765270264,
          "z": 165.01676044074327,
          "thickness": 1.00048
        },
        {
          "x": 73.83290751953125,
          "y": 118.86758767925113,
          "z": 164.97572043828754,
          "thickness": 2.44294
        },
        {
          "x": 119.45781751953125,
          "y": 122.64480790527391,
          "z": 165.0021904398714,
          "thickness": 0.0
        },
        {
          "x": 82.37783751953125,
          "y": 122.50472789689175,
          "z": 164.95707043717152,
          "thickness": 2.05102
        },
        {
          "x": 77.17613751953125,
          "y": 123.47485795494276,
          "z": 165.0109204403938,
          "thickness": 2.55457
        },
        {
          "x": 81.56341751953124,
          "y": 125.05119804926842,
          "z": 165.0166104407343,
          "thickness": 2.06125
        },
        {
          "x": 62.19330751953125,
          "y": 127.01790816695319,
          "z": 164.9577004372092,
          "thickness": 2.72213
        },
        {
          "x": 119.95587751953126,
          "y": 128.2281582393726,
          "z": 164.9873704389846,
          "thickness": 0.0
        },
        {
          "x": 58.24485751953126,
          "y": 128.61992826281548,
          "z": 164.9607104373893,
          "thickness": 2.36419
        },
        {
          "x": 120.04321751953125,
          "y": 129.08304829052784,
          "z": 165.04471044241575,
          "thickness": 0.0
        },
        {
          "x": 84.21755751953125,
          "y": 130.44801837220547,
          "z": 165.02336044113818,
          "thickness": 2.73325
        },
        {
          "x": 83.24617751953124,
          "y": 130.42453837080043,
          "z": 165.01320044053023,
          "thickness": 2.77331
        },
        {
          "x": 72.84126751953124,
          "y": 130.86567839719757,
          "z": 164.97037043796738,
          "thickness": 2.61985
        },
        {
          "x": 64.61995751953125,
          "y": 130.15844835487806,
          "z": 164.95086043679993,
          "thickness": 2.36275
        },
        {
          "x": 84.64828751953125,
          "y": 131.34904842612164,
          "z": 165.0070704401634,
          "thickness": 2.70973
        },
        {
          "x": 71.35455751953126,
          "y": 131.42626843074237,
          "z": 164.98762043899958,
          "thickness": 2.97173
        },
        {
          "x": 68.98045751953126,
          "y": 131.0956484109586,
          "z": 165.01331044053686,
          "thickness": 2.33413
        },
        {
          "x": 57.73464751953125,
          "y": 131.42008843037254,
          "z": 164.98905043908516,
          "thickness": 2.74818
        },
        {
          "x": 85.01799751953125,
          "y": 132.3015384831171,
          "z": 165.01174044044285,
          "thickness": 2.81139
        },
        {
          "x": 120.76059751953125,
          "y": 133.24304853945554,
          "z": 165.004790440027,
          "thickness": 0.0
        },
        {
          "x": 85.66197751953125,
          "y": 135.26315866033568,
          "z": 165.01402044057932,
          "thickness": 2.26153
        },
        {
          "x": 78.45099751953126,
          "y": 135.54737867734295,
          "z": 164.9651204376532,
          "thickness": 3.30784
        },
        {
          "x": 78.01555751953126,
          "y": 136.3705487266001,
          "z": 164.98705043896547,
          "thickness": 2.99215
        },
        {
          "x": 85.76534751953125,
          "y": 137.5975888000242,
          "z": 165.0021704398702,
          "thickness": 3.05578
        },
        {
          "x": 120.49365751953125,
          "y": 140.89312899722404,
          "z": 165.04154044222605,
          "thickness": 0.0
        },
        {
          "x": 73.40324751953125,
          "y": 140.0536789469927,
          "z": 165.03141044161993,
          "thickness": 1.78228
        },
        {
          "x": 72.65022751953126,
          "y": 140.67809898435698,
          "z": 165.03665044193346,
          "thickness": 1.54434
        },
        {
          "x": 61.68353751953125,
          "y": 141.40008902755972,
          "z": 165.00752044019035,
          "thickness": 2.65395
        },
        {
          "x": 120.20299751953125,
          "y": 142.47354909179384,
          "z": 164.972470438093,
          "thickness": 0.0
        },
        {
          "x": 71.72097751953126,
          "y": 141.8443890541459,
          "z": 165.0387104420567,
          "thickness": 1.62988
        },
        {
          "x": 80.03582751953125,
          "y": 146.9562493600314,
          "z": 164.99772043960394,
          "thickness": 2.42876
        },
        {
          "x": 61.40130751953125,
          "y": 147.9227494178652,
          "z": 165.04758044258747,
          "thickness": 1.93742
        },
        {
          "x": 58.95269751953125,
          "y": 148.17094943271707,
          "z": 164.95856043726067,
          "thickness": 1.82809
        },
        {
          "x": 79.15916751953125,
          "y": 148.96074947997747,
          "z": 165.02186044104843,
          "thickness": 2.06739
        },
        {
          "x": 54.58976751953125,
          "y": 149.52694951385791,
          "z": 164.9836704387632,
          "thickness": 2.66499
        },
        {
          "x": 79.60102751953124,
          "y": 150.5830795770551,
          "z": 164.95875043727204,
          "thickness": 2.43311
        },
        {
          "x": 83.32697751953125,
          "y": 151.00867960252228,
          "z": 164.9813004386214,
          "thickness": 2.70543
        },
        {
          "x": 86.17848751953125,
          "y": 154.03797978379072,
          "z": 165.0364804419233,
          "thickness": 2.40015
        },
        {
          "x": 85.57625751953125,
          "y": 154.5517098145315,
          "z": 165.00462044001682,
          "thickness": 2.47545
        },
        {
          "x": 57.068517519531255,
          "y": 154.78205982831525,
          "z": 164.9955904394765,
          "thickness": 2.02455
        },
        {
          "x": 84.53445751953126,
          "y": 155.5604198748911,
          "z": 165.0072704401754,
          "thickness": 2.2743
        },
        {
          "x": 59.65731751953125,
          "y": 154.80991982998236,
          "z": 165.0379604420118,
          "thickness": 2.75183
        },
        {
          "x": 89.01694751953124,
          "y": 156.39907992507514,
          "z": 164.9932404393359,
          "thickness": 2.45479
        },
        {
          "x": 88.88392751953126,
          "y": 157.89848001479683,
          "z": 165.02175044104183,
          "thickness": 2.42626
        },
        {
          "x": 66.45293751953125,
          "y": 158.28497003792378,
          "z": 164.9502204367616,
          "thickness": 2.8357
        },
        {
          "x": 85.35337751953125,
          "y": 159.14515008939557,
          "z": 165.02681044134465,
          "thickness": 2.35257
        },
        {
          "x": 73.87321751953125,
          "y": 159.86927013272575,
          "z": 164.98215043867228,
          "thickness": 2.5069
        },
        {
          "x": 64.61866751953124,
          "y": 161.37158022262156,
          "z": 165.0307504415804,
          "thickness": 3.34508
        },
        {
          "x": 122.82256751953125,
          "y": 163.66720035998776,
          "z": 165.0060204401006,
          "thickness": 0.0
        },
        {
          "x": 90.42921751953125,
          "y": 163.61350035677444,
          "z": 165.00724044017358,
          "thickness": 2.8654
        },
        {
          "x": 88.38796751953126,
          "y": 163.3180203390934,
          "z": 164.99075043918688,
          "thickness": 2.7658
        },
        {
          "x": 92.61026751953125,
          "y": 167.37813058204384,
          "z": 165.0079304402149,
          "thickness": 2.70755
        },
        {
          "x": 89.37558751953125,
          "y": 168.95064067614035,
          "z": 165.04277044229966,
          "thickness": 2.89107
        },
        {
          "x": 93.08889751953126,
          "y": 168.03567062138998,
          "z": 164.9794404385101,
          "thickness": 3.07531
        },
        {
          "x": 74.00225751953124,
          "y": 170.38386076190187,
          "z": 165.04796044261025,
          "thickness": 1.86854
        },
        {
          "x": 93.23884751953125,
          "y": 171.83927084899128,
          "z": 165.00887044027112,
          "thickness": 1.82825
        },
        {
          "x": 92.39978751953126,
          "y": 171.73262084260952,
          "z": 165.01882044086653,
          "thickness": 1.8325
        },
        {
          "x": 91.17089751953125,
          "y": 171.26482081461714,
          "z": 165.0380604420178,
          "thickness": 2.32561
        },
        {
          "x": 66.88871751953124,
          "y": 171.94020085503078,
          "z": 165.028370441438,
          "thickness": 3.1852
        },
        {
          "x": 93.51241751953125,
          "y": 172.66416089835138,
          "z": 164.95747043719544,
          "thickness": 2.08374
        },
        {
          "x": 91.84098751953125,
          "y": 172.37537088107064,
          "z": 165.0121004404644,
          "thickness": 2.02971
        },
        {
          "x": 121.09553751953125,
          "y": 174.3007609962829,
          "z": 165.002250439875,
          "thickness": 0.0
        },
        {
          "x": 74.33725751953125,
          "y": 176.05888110148598,
          "z": 164.9936204393586,
          "thickness": 2.155
        },
        {
          "x": 72.00427751953126,
          "y": 177.6688111978216,
          "z": 165.00559044007485,
          "thickness": 2.70181
        },
        {
          "x": 83.35287751953125,
          "y": 179.6110713140433,
          "z": 165.024460441204,
          "thickness": 1.89128
        },
        {
          "x": 81.21905751953125,
          "y": 179.19129128892436,
          "z": 165.0443404423936,
          "thickness": 2.03601
        },
        {
          "x": 77.63882751953125,
          "y": 179.12518128496845,
          "z": 164.98606043890624,
          "thickness": 2.3553
        },
        {
          "x": 74.67887751953126,
          "y": 179.2493012923956,
          "z": 164.9873004389804,
          "thickness": 2.45729
        },
        {
          "x": 85.92474751953125,
          "y": 181.05084140019684,
          "z": 164.98681043895112,
          "thickness": 2.09448
        },
        {
          "x": 116.54971751953126,
          "y": 185.07890164122946,
          "z": 165.04173044223742,
          "thickness": 2.13779
        },
        {
          "x": 90.19555751953125,
          "y": 185.3374816567025,
          "z": 165.0110504404016,
          "thickness": 2.22419
        },
        {
          "x": 113.67973751953124,
          "y": 186.04957169931282,
          "z": 165.04258044228828,
          "thickness": 2.36045
        },
        {
          "x": 90.92705751953125,
          "y": 185.97148169464,
          "z": 164.98201043866388,
          "thickness": 2.16965
        },
        {
          "x": 92.31951751953125,
          "y": 186.86838174830905,
          "z": 165.04754044258507,
          "thickness": 2.18181
        },
        {
          "x": 87.95772751953125,
          "y": 193.42109214041272,
          "z": 164.98135043862442,
          "thickness": 1.99417
        },
        {
          "x": 98.31165751953125,
          "y": 194.49311220456065,
          "z": 165.03054044156784,
          "thickness": 1.93262
        },
        {
          "x": 96.55009751953125,
          "y": 194.20476218730622,
          "z": 165.00432043999888,
          "thickness": 1.77771
        },
        {
          "x": 117.59701751953125,
          "y": 197.35690237592524,
          "z": 164.9708704379973,
          "thickness": 2.02429
        },
        {
          "x": 121.41974751953126,
          "y": 198.17550242490898,
          "z": 165.02638044131893,
          "thickness": 3.13836
        },
        {
          "x": 96.12609751953124,
          "y": 200.2687725501669,
          "z": 165.01240044048237,
          "thickness": 2.30671
        },
        {
          "x": 113.16998751953125,
          "y": 202.39299267727677,
          "z": 165.0412004422057,
          "thickness": 2.32925
        },
        {
          "x": 84.59081751953124,
          "y": 202.49597268343894,
          "z": 165.02981044152415,
          "thickness": 2.5425
        },
        {
          "x": 116.16535751953126,
          "y": 212.29364326971574,
          "z": 165.02770044139788,
          "thickness": 1.98371
        },
        {
          "x": 106.17225751953126,
          "y": 213.92676336743904,
          "z": 164.96552043767713,
          "thickness": 2.18504
        },
        {
          "x": 104.73268751953125,
          "y": 215.11975343882563,
          "z": 165.01808044082222,
          "thickness": 2.52471
        },
        {
          "x": 118.92716751953125,
          "y": 215.49703346140146,
          "z": 165.03304044171745,
          "thickness": 2.61822
        },
        {
          "x": 63.12627751953125,
          "y": 142.14750907228412,
          "z": 165.04462044241035,
          "thickness": 2.26613
        },
        {
          "x": 122.91630751953124,
          "y": 165.99040049900435,
          "z": 164.95151043683882,
          "thickness": 0.0
        },
        {
          "x": 55.09002751953125,
          "y": 120.2391377613225,
          "z": 165.04764044259107,
          "thickness": 3.52318
        },
        {
          "x": 112.52372751953125,
          "y": 106.60371694540088,
          "z": 165.00506044004317,
          "thickness": 2.79577
        },
        {
          "x": 119.88381751953125,
          "y": 126.10849811253554,
          "z": 164.99441043940587,
          "thickness": 0.0
        },
        {
          "x": 111.65944751953126,
          "y": 196.79577234234813,
          "z": 164.96100043740668,
          "thickness": 2.58263
        },
        {
          "x": 113.06795751953125,
          "y": 104.81867683858695,
          "z": 165.0319204416504,
          "thickness": 2.46447
        },
        {
          "x": 90.99240751953124,
          "y": 88.42261585747309,
          "z": 165.02229044107415,
          "thickness": 2.07714
        },
        {
          "x": 115.61167751953126,
          "y": 195.81426228361616,
          "z": 164.9540004369878,
          "thickness": 1.84278
        },
        {
          "x": 58.98565751953125,
          "y": 140.3141489625788,
          "z": 164.97270043810678,
          "thickness": 2.74123
        },
        {
          "x": 62.79185751953125,
          "y": 127.57871820051115,
          "z": 165.02568044127705,
          "thickness": 2.34468
        },
        {
          "x": 119.95401751953125,
          "y": 180.1030313434814,
          "z": 165.02698044135482,
          "thickness": 2.3236
        },
        {
          "x": 67.86552751953124,
          "y": 157.3406099814148,
          "z": 164.9819104386579,
          "thickness": 2.67363
        },
        {
          "x": 62.53944751953125,
          "y": 94.61391622795051,
          "z": 164.98488043883563,
          "thickness": 2.77002
        },
        {
          "x": 106.78969751953125,
          "y": 75.65873509370303,
          "z": 164.97110043801106,
          "thickness": 2.50212
        },
        {
          "x": 66.69023751953125,
          "y": 82.73307551702017,
          "z": 165.0492804426892,
          "thickness": 2.529
        },
        {
          "x": 104.12927751953126,
          "y": 101.63409664802681,
          "z": 164.9923804392844,
          "thickness": 2.1897
        },
        {
          "x": 114.07418751953125,
          "y": 112.37014729045477,
          "z": 165.00503044004134,
          "thickness": 3.30267
        },
        {
          "x": 114.06354751953126,
          "y": 93.26241614707892,
          "z": 164.9761904383156,
          "thickness": 3.38232
        },
        {
          "x": 114.69379751953124,
          "y": 185.29882165438912,
          "z": 165.00074043978466,
          "thickness": 2.24982
        },
        {
          "x": 82.31937751953126,
          "y": 147.18324937361473,
          "z": 165.02051044096766,
          "thickness": 2.90331
        },
        {
          "x": 74.80121751953125,
          "y": 144.99637924275592,
          "z": 165.0171604407672,
          "thickness": 2.26216
        },
        {
          "x": 82.78556751953124,
          "y": 179.63476131546085,
          "z": 164.95102043680947,
          "thickness": 1.90377
        },
        {
          "x": 60.32300751953125,
          "y": 125.87787809873562,
          "z": 165.01689044075104,
          "thickness": 3.10788
        },
        {
          "x": 56.46629751953125,
          "y": 125.90846810056607,
          "z": 164.9869404389589,
          "thickness": 2.2568
        },
        {
          "x": 91.69493751953125,
          "y": 171.68292083963556,
          "z": 164.99461043941784,
          "thickness": 1.97758
        },
        {
          "x": 92.85853751953125,
          "y": 188.05033181903505,
          "z": 164.96994043794163,
          "thickness": 2.09966
        },
        {
          "x": 114.69982751953125,
          "y": 77.70569521618982,
          "z": 164.9863604389242,
          "thickness": 1.88263
        },
        {
          "x": 70.74318751953125,
          "y": 80.64104539183644,
          "z": 164.99225043927663,
          "thickness": 2.80534
        },
        {
          "x": 88.46841751953124,
          "y": 193.2089621277192,
          "z": 165.04770044259467,
          "thickness": 1.95999
        },
        {
          "x": 68.50940751953125,
          "y": 161.40267022448194,
          "z": 165.02680044134405,
          "thickness": 2.45127
        },
        {
          "x": 65.68362751953126,
          "y": 108.53276706083213,
          "z": 165.034720441818,
          "thickness": 2.93139
        }
      ],
      "slice_pos": 165.0
    }

    mockData["vertexes"].forEach(v => {
      var p_x = Math.round(v.x)
      var p_y = Math.round(v.y)

      // console.log(p_x, p_y)

      var index = (p_x + p_y * 255) * 4
      data[index] = 255
      data[index + 3] = 255
    });
  }

  //
  // THE VOLUME DATA
  //
  volume = new X.volume();
  // .. and attach the single-file dicom in .NRRD format
  // this works with gzip/gz/raw encoded NRRD files but XTK also supports other
  // formats like MGH/MGZ
  // volume.file = 'static/data/orig.mgz';
  // volume.file = 'static/data/wm.mgz';
  volume.file = 'static/data/brain.mgz';

  sliceX.add(volume);
  sliceX.render();

  function tryRenderPoints3D() {
    text = readTextFile("static/data/lh.thickness.asc", function (text) {
      points = new X.object();
      for (let i = 0; i < text.length; i += 200) {
        let px = text[i].split(" ")[1]
        let py = text[i].split(" ")[2]
        let pz = text[i].split(" ")[3]

        var newSphere = new X.sphere();
        newSphere.center = [px, py, pz];
        newSphere.radius = 0.7;
        newSphere.magicmode = true; // it's magic..
        newSphere.modified(); // since we don't directly add the sphere, we have to
        // call the CSG creator manually

        // .. add the newSphere to our container
        points.children.push(newSphere);
      }
      threeD.add(points)
    })
  }
  // tryRenderPoints()


  //
  // THE GUI
  //
  sliceX.onShowtime = function () {
    sliceY.add(volume);
    sliceY.render();
    sliceZ.add(volume);
    sliceZ.render();

    if (_webGLFriendly) {
      threeD.add(volume);

      var p = new X.mesh();

      function testRenderLhPial() {
        p.file = 'static/data/lh.pial';

        threeD.add(p);
      }
      // testRenderLhPial()

      threeD.render();
    }

    function setupGUI() {
      // now the real GUI
      var gui = new dat.GUI();

      // the following configures the gui for interacting with the X.volume
      var volumegui = gui.addFolder('Volume');
      // now we can configure controllers which..
      // .. switch between slicing and volume rendering
      var vrController = volumegui.add(volume, 'volumeRendering');
      // .. configure the volume rendering opacity
      var opacityController = volumegui.add(volume, 'opacity', 0, 1);
      // .. and the threshold in the min..max range
      var lowerThresholdController = volumegui.add(volume, 'lowerThreshold',
        volume.min, volume.max);
      var upperThresholdController = volumegui.add(volume, 'upperThreshold',
        volume.min, volume.max);
      var lowerWindowController = volumegui.add(volume, 'windowLow', volume.min,
        volume.max);
      var upperWindowController = volumegui.add(volume, 'windowHigh', volume.min,
        volume.max);
      // the indexX,Y,Z are the currently displayed slice indices in the range
      // 0..dimensions-1
      var sliceXController = volumegui.add(volume, 'indexX', 0,
        volume.range[0] - 1);
      var sliceYController = volumegui.add(volume, 'indexY', 0,
        volume.range[1] - 1);
      var sliceZController = volumegui.add(volume, 'indexZ', 0,
        volume.range[2] - 1);
      volumegui.open();
    }
    setupGUI()
  }
};
